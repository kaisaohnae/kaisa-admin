"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98],{16770:(e,t,o)=>{o.d(t,{A:()=>Q}),o(20095),o(78033),o(6029),o(24059),o(57586),o(48219),o(30720),o(39463),o(99921),o(20867),o(78151),o(60778),o(2049),o(90075);var r=o(50968),n=o(34517),l=o(54992),i=o(62837),s=o(20087),a=o(25138),u=o(4364),c=o(32706),d=o(11830),h=o(2206),f=o(83950),g=o(79081),m=o(40515),p=o(98802),w=o(42176),C=o(44754),y=o(1327),v=o(96501),R=o(27305),b=o(47339),S=o(78056),E=o(86753),H=o(55412),A=o(61101),M=o(5353),I=o(62342),x=o(40223),k=o(78831),_=o(27303),T=o(99818),F=o(62185),V=o(48574),D=o(61731),L=o(73041),N=o(86901),P=o(39191);let O=null,j=new Map;function Q(e,t){let o,Q,z,W,B,K;var U,q=this;let $=arguments.length>2&&void 0!==arguments[2]&&arguments[2],J=this,G=new a.A(J),Y=!0;(0,S.K5)($)&&(0,S.JP)(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;let Z=null!==(U=null==t?void 0:t.layoutDirection)&&void 0!==U?U:"inherit",X=["rtl","ltr"].includes(Z)?Z:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",X),this.isRtl=function(){return"rtl"===X},this.isLtr=function(){return!J.isRtl()},this.getDirectionFactor=function(){return J.isLtr()?1:-1},t.language=(0,A.Mj)(t.language);let ee=new x.A(J,t,[k.J,_.Z]),et=ee.getTableMeta(),eo=ee.getGlobalMeta(),er=(0,D.u)();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),(0,S.yn)(this)&&((0,l._injectProductInfo)(t.licenseKey,e),(0,r.addClass)(e,"ht-wrapper")),this.guid=`ht_${(0,w.randomString)()}`,j.set(this.guid,this),this.columnIndexMapper=new b._,this.rowIndexMapper=new b._,this.columnIndexMapper.addLocalHook("indexesSequenceChange",e=>{J.runHooks("afterColumnSequenceChange",e)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",e=>{J.runHooks("afterRowSequenceChange",e)}),Q=new v.A(J),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let en=new I.A(et,{rowIndexMapper:J.rowIndexMapper,columnIndexMapper:J.columnIndexMapper,countCols:()=>J.countCols(),countRows:()=>J.countRows(),propToCol:e=>o.propToCol(e),isEditorOpened:()=>!!J.getActiveEditor()&&J.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return q.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return q.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>J.getShortcutManager(),createCellCoords:(e,t)=>J._createCellCoords(e,t),createCellRange:(e,t,o)=>J._createCellRange(e,t,o),visualToRenderableCoords:e=>{let{row:t,col:o}=e;return J._createCellCoords(t>=0?J.rowIndexMapper.getRenderableFromVisualIndex(t):t,o>=0?J.columnIndexMapper.getRenderableFromVisualIndex(o):o)},renderableToVisualCoords:e=>{let{row:t,col:o}=e;return J._createCellCoords(t>=0?J.rowIndexMapper.getVisualFromRenderableIndex(t):t,o>=0?J.columnIndexMapper.getVisualFromRenderableIndex(o):o)},findFirstNonHiddenRenderableRow:(e,t)=>{let o=t>e?1:-1,r=Math.min(e,t),n=Math.max(e,t),l=J.rowIndexMapper.getNearestNotHiddenIndex(e,o);return null===l||1===o&&l>n||-1===o&&l<r?null:l>=0?J.rowIndexMapper.getRenderableFromVisualIndex(l):l},findFirstNonHiddenRenderableColumn:(e,t)=>{let o=t>e?1:-1,r=Math.min(e,t),n=Math.max(e,t),l=J.columnIndexMapper.getNearestNotHiddenIndex(e,o);return null===l||1===o&&l>n||-1===o&&l<r?null:l>=0?J.columnIndexMapper.getRenderableFromVisualIndex(l):l},isDisabledCellSelection:(e,t)=>e<0||t<0?J.getSettings().disableVisualSelection:J.getCellMeta(e,t).disableVisualSelection});this.selection=en;let el=e=>{let{hiddenIndexesChanged:t}=e;t&&this.selection.commit()};function ei(e,t){let o="className"===e?J.rootElement:J.table;if(Y)(0,r.addClass)(o,t);else{let n=[],l=[];eo[e]&&(n=Array.isArray(eo[e])?eo[e]:(0,d.stringToArray)(eo[e])),t&&(l=Array.isArray(t)?t:(0,d.stringToArray)(t));let i=(0,d.getDifferenceOfArrays)(n,l),s=(0,d.getDifferenceOfArrays)(l,n);i.length&&(0,r.removeClass)(o,i),s.length&&(0,r.addClass)(o,s)}eo[e]=t}function es(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function ea(e,t,r){if(!e.length){r();return}let n=J.getActiveEditor(),l=new es,i=!0;l.onQueueEmpty=()=>{n&&i&&n.cancelChanges(),r()};for(let r=e.length-1;r>=0;r--){let n;let[s,a]=e[r],u=o.propToCol(a);n=Number.isInteger(u)?J.getCellMeta(s,u):{...Object.getPrototypeOf(et),...et},J.getCellValidator(n)&&(l.addValidatorToQueue(),J.validateCell(e[r][3],n,function(t,o){return function(r){if("boolean"!=typeof r)throw Error("Validation error: result is not boolean");!1===r&&!1===o.allowInvalid&&(i=!1,e.splice(t,1),o.valid=!0),l.removeValidatorFormQueue()}}(r,n),t))}l.checkIfQueueIsEmpty()}function eu(e,t){for(let t=e.length-1;t>=0;t--){let r=!1;if(null===e[t]){e.splice(t,1);continue}if(null!==e[t][2]&&void 0!==e[t][2]||null!==e[t][3]&&void 0!==e[t][3]){if(et.allowInsertRow)for(;e[t][0]>J.countRows()-1;){let{delta:e}=o.createRow(void 0,void 0,{source:"auto"});if(0===e){r=!0;break}}if("array"===J.dataType&&(!et.columns||0===et.columns.length)&&et.allowInsertColumn)for(;o.propToCol(e[t][1])>J.countCols()-1;){let{delta:e}=o.createCol(void 0,void 0,{source:"auto"});if(0===e){r=!0;break}}r||o.set(e[t][0],e[t][1],e[t][3])}}let r=e.length>0;if(J.forceFullRender=!0,r){z.adjustRowsAndCols(),J.runHooks("beforeChangeRender",e,t),W.closeEditor(),J.view.render(),W.prepareEditor(),J.view.adjustElementsSize(),J.runHooks("afterChange",e,t||"edit");let o=J.getActiveEditor();o&&(0,l.isDefined)(o.refreshValue)&&o.refreshValue()}else J.view.render()}function ec(e,t,o){return Array.isArray(e)?e:[[e,t,o]]}function ed(e,t){let r=J.runHooks("beforeChange",e,t||"edit"),n=e.filter(e=>null!==e);if(!1===r||0===n.length){var l;return null===(l=J.getActiveEditor())||void 0===l||l.cancelChanges(),[]}for(let e=n.length-1;e>=0;e--){let[t,r,,l]=n[e],i=o.propToCol(r);"numeric"===(Number.isInteger(i)?J.getCellMeta(t,i):{...Object.getPrototypeOf(et),...et}).type&&"string"==typeof l&&(0,C.isNumericLike)(l)&&(n[e][3]=function(e){let t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}(l))}return n}this.columnIndexMapper.addLocalHook("cacheUpdated",el),this.rowIndexMapper.addLocalHook("cacheUpdated",el),this.selection.addLocalHook("afterSetRangeEnd",(e,t)=>{let o=(0,u.createObjectPropListener)(!1),n=this.selection.getSelectedRange(),{from:l,to:i}=n.current(),s=n.size()-1;this.runHooks("afterSelection",l.row,l.col,i.row,i.col,o,s),this.runHooks("afterSelectionByProp",l.row,J.colToProp(l.col),i.row,J.colToProp(i.col),o,s),t&&(!o.isTouched()||o.isTouched()&&!o.value)&&K.scrollTo(e);let a=en.isSelectedByRowHeader(),c=en.isSelectedByColumnHeader();a&&c?(0,r.addClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]):a?((0,r.removeClass)(this.rootElement,"ht__selection--columns"),(0,r.addClass)(this.rootElement,"ht__selection--rows")):c?((0,r.removeClass)(this.rootElement,"ht__selection--rows"),(0,r.addClass)(this.rootElement,"ht__selection--columns")):(0,r.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==en.getSelectionSource()&&W.closeEditor(null),J.view.render(),W.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",e=>{this.runHooks("beforeSelectionFocusSet",e.row,e.col)}),this.selection.addLocalHook("afterSetFocus",e=>{let t=(0,u.createObjectPropListener)(!1);this.runHooks("afterSelectionFocusSet",e.row,e.col,t),(!t.isTouched()||t.isTouched()&&!t.value)&&K.scrollTo(e),W.closeEditor(),J.view.render(),W.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",e=>{let t=e.length-1,{from:o,to:r}=e[t];this.runHooks("afterSelectionEnd",o.row,o.col,r.row,r.col,t),this.runHooks("afterSelectionEndByProp",o.row,J.colToProp(o.col),r.row,J.colToProp(r.col),t)}),this.selection.addLocalHook("afterIsMultipleSelection",e=>{let t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)}),this.selection.addLocalHook("afterDeselect",()=>{W.closeEditor(),J.view.render(),(0,r.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeSetRangeStart",...t)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeSetRangeStartOnly",...t)}).addLocalHook("beforeSetRangeEnd",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeSetRangeEnd",...t)}).addLocalHook("beforeSelectColumns",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeSelectColumns",...t)}).addLocalHook("afterSelectColumns",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("afterSelectColumns",...t)}).addLocalHook("beforeSelectRows",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeSelectRows",...t)}).addLocalHook("afterSelectRows",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("afterSelectRows",...t)}).addLocalHook("beforeModifyTransformStart",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("modifyTransformStart",...t)}).addLocalHook("afterModifyTransformStart",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("afterModifyTransformStart",...t)}).addLocalHook("beforeModifyTransformFocus",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("modifyTransformFocus",...t)}).addLocalHook("afterModifyTransformFocus",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("afterModifyTransformFocus",...t)}).addLocalHook("beforeModifyTransformEnd",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("modifyTransformEnd",...t)}).addLocalHook("afterModifyTransformEnd",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("afterModifyTransformEnd",...t)}).addLocalHook("beforeRowWrap",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeRowWrap",...t)}).addLocalHook("beforeColumnWrap",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeColumnWrap",...t)}).addLocalHook("insertRowRequire",e=>this.alter("insert_row_above",e,1,"auto")).addLocalHook("insertColRequire",e=>this.alter("insert_col_start",e,1,"auto")),z={alter(e,t){var r,n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,u=e=>{if(0===e.length)return[];let t=[...e];return t.sort((e,t)=>{let[o]=e,[r]=t;return o===r?0:o>r?1:-1}),(0,d.arrayReduce)(t,(e,t)=>{let[o,r]=t,n=e[e.length-1],[l,i]=n,s=l+i;if(o<=s){let e=Math.max(r-(s-o),0);n[1]+=e}else e.push([o,r]);return e},[t[0]])};switch(e){case"insert_row_below":case"insert_row_above":let c=J.countSourceRows();if(et.maxRows===c)return;let h="insert_row_below"===e?"below":"above";t=null!=t?t:"below"===h?c:0;let{delta:f,startPhysicalIndex:g}=o.createRow(t,i,{source:s,mode:h});en.shiftRows(J.toVisualRow(g),f);break;case"insert_col_start":case"insert_col_end":let m="insert_col_end"===e?"end":"start";t=null!=t?t:"end"===m?J.countSourceCols():0;let{delta:p,startPhysicalIndex:w}=o.createCol(t,i,{source:s,mode:m});if(p){if(Array.isArray(et.colHeaders)){let e=[J.toVisualColumn(w),0];e.length+=p,Array.prototype.splice.apply(et.colHeaders,e)}en.shiftColumns(J.toVisualColumn(w),p)}break;case"remove_row":let C;r=Array.isArray(t)?u(t):[[t,i]],C=0,(0,d.arrayEach)(r,e=>{let[t,r]=e,n=(0,l.isEmpty)(t)?J.countRows()-1:Math.max(t-C,0);if(Number.isInteger(t)&&(t=Math.max(t-C,0)),!o.removeRow(t,r,s))return;if(en.isSelected()){let{row:e}=J.getSelectedRangeLast().highlight;e>=t&&e<=t+r-1&&W.closeEditor(!0)}let i=J.countRows();0===i?en.deselect():"ContextMenu.removeRow"===s?en.refresh():en.shiftRows(t,-r);let a=et.fixedRowsTop;a>=n+1&&(et.fixedRowsTop-=Math.min(r,a-n));let u=et.fixedRowsBottom;u&&n>=i-u&&(et.fixedRowsBottom-=Math.min(r,u)),C+=r});break;case"remove_col":let y;n=Array.isArray(t)?u(t):[[t,i]],y=0,(0,d.arrayEach)(n,e=>{let[t,r]=e,n=(0,l.isEmpty)(t)?J.countCols()-1:Math.max(t-y,0),i=J.toPhysicalColumn(n);if(Number.isInteger(t)&&(t=Math.max(t-y,0)),!o.removeCol(t,r,s))return;if(en.isSelected()){let{col:e}=J.getSelectedRangeLast().highlight;e>=t&&e<=t+r-1&&W.closeEditor(!0)}0===J.countCols()?en.deselect():"ContextMenu.removeColumn"===s?en.refresh():en.shiftColumns(t,-r);let a=et.fixedColumnsStart;a>=n+1&&(et.fixedColumnsStart-=Math.min(r,a-n)),Array.isArray(et.colHeaders)&&(void 0===i&&(i=-1),et.colHeaders.splice(i,r)),y+=r});break;default:throw Error(`There is no such action "${e}"`)}a||z.adjustRowsAndCols(),J.view.render(),J.view.adjustElementsSize()},adjustRowsAndCols(){let e=et.minRows,t=et.minSpareRows,r=et.minCols,n=et.minSpareCols;if(e){let t=J.countRows();t<e&&o.createRow(t,e-t,{source:"auto"})}if(t){let e=J.countEmptyRows(!0);if(e<t){let r=Math.min(t-e,et.maxRows-J.countSourceRows());o.createRow(J.countRows(),r,{source:"auto"})}}{let e;(r||n)&&(e=J.countEmptyCols(!0));let t=J.countCols();if(r&&!et.columns&&t<r){let n=r-t;e+=n,o.createCol(t,n,{source:"auto"})}if(n&&!et.columns&&"array"===J.dataType&&e<n){t=J.countCols();let r=Math.min(n-e,et.maxCols-t);o.createCol(t,r,{source:"auto"})}}},populateFromArray(e,t,o,r,n){let l,i,s,a,c;let h=[],f={},g=[],m=e.row,p=e.col;if(0===(i=t.length))return!1;let w=0,C=0;switch((0,u.isObject)(o)&&(w=o.col-p+1,C=o.row-m+1),n){case"shift_down":let y=(0,d.pivot)(t),v=y.length,R=Math.max(v,w),b=J.getData().slice(m),S=(0,d.pivot)(b).slice(p,p+R);for(s=0;s<R;s+=1)if(s<v){for(l=0,i=y[s].length;l<C-i;l+=1)y[s].push(y[s][l%i]);s<S.length?g.push(y[s].concat(S[s])):g.push(y[s].concat(Array(b.length).fill(null)))}else g.push(y[s%v].concat(S[s]));J.populateFromArray(m,p,(0,d.pivot)(g));break;case"shift_right":let E=t.length,H=Math.max(E,C),A=J.getData().slice(m).map(e=>e.slice(p));for(l=0;l<H;l+=1)if(l<E){for(s=0,a=t[l].length;s<w-a;s+=1)t[l].push(t[l][s%a]);if(l<A.length)for(let e=0;e<A[l].length;e+=1)t[l].push(A[l][e]);else t[l].push(...Array(A[0].length).fill(null))}else t.push(t[l%i].slice(0,H).concat(A[l]));J.populateFromArray(m,p,t);break;default:f.row=e.row,f.col=e.col;let M=0,I=0,x=!0,k=function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t[e%t.length];return null!==o?r[o%r.length]:r},_=t.length,T=o?o.row-e.row+1:0;for(l=0,i=o?T:Math.max(_,T);l<i&&!(o&&f.row>o.row&&T>_||!et.allowInsertRow&&f.row>J.countRows()-1)&&!(f.row>=et.maxRows);l++){let t=l-M,n=k(t).length,d=o?o.col-e.col+1:0;if(a=o?d:Math.max(n,d),f.col=e.col,c=J.getCellMeta(f.row,f.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&c.skipRowOnPaste){M+=1,f.row+=1,i+=1;continue}for(s=0,I=0;s<a&&!(o&&f.col>o.col&&d>n||!et.allowInsertColumn&&f.col>J.countCols()-1)&&!(f.col>=et.maxCols);s++){if(c=J.getCellMeta(f.row,f.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&c.skipColumnOnPaste){I+=1,f.col+=1,a+=1;continue}if(c.readOnly&&"UndoRedo.undo"!==r){f.col+=1;continue}let e=k(t,s-I),o=J.getDataAtCell(f.row,f.col);if(null!==e&&"object"==typeof e){if(Array.isArray(e)&&null===o&&(o=[]),null===o||"object"!=typeof o)x=!1;else{let t=(0,u.duckSchema)(Array.isArray(o)?o:o[0]||o),r=(0,u.duckSchema)(Array.isArray(e)?e:e[0]||e);(0,u.isObjectEqual)(t,r)||Array.isArray(t)&&Array.isArray(r)?e=(0,u.deepClone)(e):x=!1}}else null!==o&&"object"==typeof o&&(x=!1);x&&h.push([f.row,f.col,e]),x=!0,f.col+=1}f.row+=1}J.setDataAtCell(h,null,null,r||"populateFromArray")}}},this.init=function(){Q.setData(et.data),J.runHooks("beforeInit"),((0,i.isMobileBrowser)()||(0,i.isIpadOS)())&&(0,r.addClass)(J.rootElement,"mobile"),this.updateSettings(et,!0),this.view=new y.A(this);let e=et.themeName||(0,P.J)(J.rootElement);J.useTheme(e),J.view.addClassNameToLicenseElement(J.getCurrentThemeName()),W=s.A.getInstance(J,et,en),K=(0,F.z)(J),B=new c.c(J),(0,S.yn)(this)&&(0,V.E)(J),J.runHooks("init"),this.forceFullRender=!0,this.view.render(),Y&&null===J.rootElement.offsetParent&&(0,r.observeVisibilityChangeOnce)(J.rootElement,()=>{J.view._wt.wtOverlays.updateLastSpreaderSize(),J.render(),J.view.adjustElementsSize()}),"object"==typeof Y&&(J.runHooks("afterChange",Y[0],Y[1]),Y=!1),J.runHooks("afterInit")},this._createCellCoords=function(e,t){return J.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,o){return J.view._wt.createCellRange(e,t,o)},this.validateCell=function(e,t,o,r){let i=J.getCellValidator(t);function s(e){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!r||!0===t.hidden){o(e);return}let n=t.visualCol,l=t.visualRow,i=J.getCell(l,n,!0);if(i&&"TH"!==i.nodeName){let e=J.rowIndexMapper.getRenderableFromVisualIndex(l),t=J.columnIndexMapper.getRenderableFromVisualIndex(n);J.view._wt.getSetting("cellRenderer",e,t,i)}o(e)}if((0,l.isRegExp)(i)){var a;a=i,i=function(e,t){t(a.test(e))}}(0,n.isFunction)(i)?(e=J.runHooks("beforeValidate",e,t.visualRow,t.prop,r),J._registerImmediate(()=>{i.call(t,e,o=>{J&&(o=J.runHooks("afterValidate",o,e,t.visualRow,t.prop,r),t.valid=o,s(o),J.runHooks("postAfterValidate",o,e,t.visualRow,t.prop,r))})})):J._registerImmediate(()=>{t.valid=!0,s(t.valid,!1)})},this.setDataAtCell=function(e,t,r,n){let l,i,s;let a=ec(e,t,r),u=[],c=n;for(l=0,i=a.length;l<i;l++){if("object"!=typeof a[l])throw Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof a[l][1])throw Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");s=a[l][1]>=this.countCols()?a[l][1]:o.colToProp(a[l][1]),u.push([a[l][0],s,Q.getAtCell(this.toPhysicalRow(a[l][0]),a[l][1]),a[l][2]])}c||"object"!=typeof e||(c=t);let d=ed(u,c);J.runHooks("afterSetDataAtCell",d,c),ea(d,c,()=>{eu(d,c)})},this.setDataAtRowProp=function(e,t,o,r){let n,l;let i=ec(e,t,o),s=[],a=r;for(n=0,l=i.length;n<l;n++)s.push([i[n][0],i[n][1],Q.getAtCell(this.toPhysicalRow(i[n][0]),i[n][1]),i[n][2]]);a||"object"!=typeof e||(a=t);let u=ed(s,r);J.runHooks("afterSetDataAtRowProp",u,a),ea(u,a,()=>{eu(u,a)})},this.listen=function(){J&&!J.isListening()&&(j.forEach(e=>{J!==e&&e.unlisten()}),O=J.guid,J.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(O=null,J.runHooks("afterUnlisten"))},this.isListening=function(){return O===J.guid},this.destroyEditor=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];W.closeEditor(e),J.view.render(),t&&en.isSelected()&&W.prepareEditor()},this.populateFromArray=function(e,t,o,r,n,l,i){if(!("object"==typeof o&&"object"==typeof o[0]))throw Error("populateFromArray parameter `input` must be an array of arrays");let s="number"==typeof r?J._createCellCoords(r,n):null;return z.populateFromArray(J._createCellCoords(e,t),o,s,l,i)},this.spliceCol=function(e,t,r){for(var n=arguments.length,l=Array(n>3?n-3:0),i=3;i<n;i++)l[i-3]=arguments[i];return o.spliceCol(e,t,r,...l)},this.spliceRow=function(e,t,r){for(var n=arguments.length,l=Array(n>3?n-3:0),i=3;i<n;i++)l[i-3]=arguments[i];return o.spliceRow(e,t,r,...l)},this.getSelected=function(){if(en.isSelected())return(0,d.arrayMap)(en.getSelectedRange(),e=>{let{from:t,to:o}=e;return[t.row,t.col,o.row,o.col]})},this.getSelectedLast=function(){let e;let t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(en.isSelected())return Array.from(en.getSelectedRange())},this.getSelectedRangeLast=function(){let e;let t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(e){if(!en.isSelected()||0===this.countRows()||0===this.countCols())return;let t=[];(0,d.arrayEach)(en.getSelectedRange(),e=>{if(e.isSingleHeader())return;let o=e.getTopStartCorner(),r=e.getBottomEndCorner();(0,C.rangeEach)(o.row,r.row,e=>{(0,C.rangeEach)(o.col,r.col,o=>{this.getCellMeta(e,o).readOnly||t.push([e,o,null])})})}),t.length>0&&this.setDataAtCell(t,e)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){let e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():J.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||J.view.render())},this.batchRender=function(e){this.suspendRender();let t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();let o=e();return this.resumeExecution(t),o},this.batch=function(e){this.suspendRender(),this.suspendExecution();let t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(!J.view)return;let e=J.view,{width:t,height:o}=e.getLastSize(),{width:r,height:n}=J.rootElement.getBoundingClientRect(),l=r!==t||n!==o;!1!==J.runHooks("beforeRefreshDimensions",{width:t,height:o},{width:r,height:n},l)&&((l||e._wt.wtOverlays.scrollableElement===J.rootWindow)&&(e.setLastSize(r,n),J.render(),e.adjustElementsSize()),J.runHooks("afterRefreshDimensions",{width:t,height:o},{width:r,height:n},l))},this.updateData=function(e,t){(0,T.p)(e,e=>{o=e},e=>{o=e,J.columnIndexMapper.fitToLength(this.getInitialColumnCount()),J.rowIndexMapper.fitToLength(this.countSourceRows()),z.adjustRowsAndCols(),en.refresh()},{hotInstance:J,dataMap:o,dataSource:Q,internalSource:"updateData",source:t,metaManager:ee,firstRun:Y})},this.loadData=function(e,t){(0,T.p)(e,e=>{o=e},()=>{ee.clearCellsCache(),J.initIndexMappers(),z.adjustRowsAndCols(),en.refresh(),Y&&(Y=[null,"loadData"])},{hotInstance:J,dataMap:o,dataSource:Q,internalSource:"loadData",source:t,metaManager:ee,firstRun:Y})},this.getInitialColumnCount=function(){let e=et.columns,t=0;if(Array.isArray(e))t=e.length;else if((0,n.isFunction)(e)){if("array"===J.dataType){let o=this.countSourceCols();for(let r=0;r<o;r+=1)e(r)&&(t+=1)}else("object"===J.dataType||"function"===J.dataType)&&(t=o.colToPropCache.length)}else if((0,l.isDefined)(et.dataSchema)){let e=o.getSchema();t=Array.isArray(e)?e.length:(0,u.deepObjectSize)(e)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,r,n){return(0,l.isUndefined)(e)?o.getAll():o.getRange(J._createCellCoords(e,t),J._createCellCoords(r,n),o.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,r,n){return o.getCopyableText(J._createCellCoords(e,t),J._createCellCoords(r,n))},this.getCopyableData=function(e,t){return o.getCopyable(e,o.colToProp(t))},this.getSchema=function(){return o.getSchema()},this.updateSettings=function(e){let t,r,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=(Y?J.loadData:J.updateData).bind(this),a=!1;if((0,l.isDefined)(e.rows))throw Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if((0,l.isDefined)(e.cols))throw Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if((0,l.isDefined)(e.ganttChart))throw Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(t in e)"data"===t||("language"===t?function(e){let t=(0,M.Jn)(e);(0,A.Lp)(t)?(J.runHooks("beforeLanguageChange",t),eo.language=t,J.runHooks("afterLanguageChange",t)):(0,M.A$)(e)}(e.language):"className"===t?ei("className",e.className):"tableClassName"===t&&J.table?(ei("tableClassName",e.tableClassName),J.view._wt.wtOverlays.syncOverlayTableClassNames()):H.R.getSingleton().isRegistered(t)||H.R.getSingleton().isDeprecated(t)?(0,n.isFunction)(e[t])?H.R.getSingleton().addAsFixed(t,e[t],J):Array.isArray(e[t])&&H.R.getSingleton().add(t,e[t],J):!i&&(0,u.hasOwnProperty)(e,t)&&(eo[t]=e[t]));void 0===e.data&&void 0===et.data?s(null,"updateSettings"):void 0!==e.data?s(e.data,"updateSettings"):void 0!==e.columns&&(o.createMap(),J.initIndexMappers());let c=J.countCols(),d=et.columns;if(d&&(0,n.isFunction)(d)&&(a=!0),(void 0!==e.cell||void 0!==e.cells||void 0!==e.columns)&&ee.clearCache(),c>0)for(t=0,r=0;t<c;t++){if(d){let e=a?d(t):d[r];e&&ee.updateColumnMeta(r,e)}r+=1}(0,l.isDefined)(e.cell)&&(0,u.objectEach)(e.cell,e=>{J.setCellMetaObject(e.row,e.col,e)}),J.runHooks("afterCellMetaReset");let h=J.rootElement.style.height;""!==h&&(h=parseInt(J.rootElement.style.height,10));let f=e.height;if((0,n.isFunction)(f)&&(f=f()),i&&J.rootElement.getAttribute("style")&&J.rootElement.setAttribute("data-initialstyle",J.rootElement.getAttribute("style")),null===f){let e=J.rootElement.getAttribute("data-initialstyle");e&&(e.indexOf("height")>-1||e.indexOf("overflow")>-1)?J.rootElement.setAttribute("style",e):(J.rootElement.style.height="",J.rootElement.style.overflow="")}else void 0!==f&&(J.rootElement.style.height=isNaN(f)?`${f}`:`${f}px`,J.rootElement.style.overflow="hidden");if(void 0!==e.width){let t=e.width;(0,n.isFunction)(t)&&(t=t()),J.rootElement.style.width=isNaN(t)?`${t}`:`${t}px`}if(!i){if(J.view){J.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),J.view._wt.exportSettingsAsClassNames();let t=J.getCurrentThemeName(),o=(0,u.hasOwnProperty)(e,"themeName");t&&o&&t!==e.themeName&&(J.view.getStylesHandler().removeClassNames(),J.view.removeClassNameFromLicenseElement(t));let r=o&&e.themeName||(0,P.J)(J.rootElement);J.useTheme(r),J.view.addClassNameToLicenseElement(J.getCurrentThemeName())}J.runHooks("afterUpdateSettings",e)}z.adjustRowsAndCols(),J.view&&!Y&&(J.forceFullRender=!0,J.view.render(),J.view._wt.wtOverlays.adjustElementsSize()),!i&&J.view&&(""===h||""===f||void 0===f)&&h!==f&&J.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){let e=J.getSelectedLast();if(et.getValue){if((0,n.isFunction)(et.getValue))return et.getValue.call(J);if(e)return J.getData()[e[0][0]][et.getValue]}else if(e)return J.getDataAtCell(e[0],e[1])},this.getSettings=function(){return et},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,o,r,n){z.alter(e,t,o,r,n)},this.getCell=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,n=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;n=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===n||null===r||void 0===n||void 0===r?null:J.view.getCellAtCoords(J._createCellCoords(n,r),o)},this.getCoords=function(e){let t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;let{row:o,col:r}=t,n=o,l=r;return o>=0&&(n=this.rowIndexMapper.getVisualFromRenderableIndex(o)),r>=0&&(l=this.columnIndexMapper.getVisualFromRenderableIndex(r)),J._createCellCoords(n,l)},this.colToProp=function(e){return o.colToProp(e)},this.propToCol=function(e){return o.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return o.get(e,o.colToProp(t))},this.getDataAtRowProp=function(e,t){return o.get(e,t)},this.getDataAtCol=function(e){let t=[],r=o.getRange(J._createCellCoords(0,e),J._createCellCoords(et.data.length-1,e),o.DESTINATION_RENDERER);for(let e=0;e<r.length;e+=1)for(let o=0;o<r[e].length;o+=1)t.push(r[e][o]);return t},this.getDataAtProp=function(e){let t=[],r=o.getRange(J._createCellCoords(0,o.propToCol(e)),J._createCellCoords(et.data.length-1,o.propToCol(e)),o.DESTINATION_RENDERER);for(let e=0;e<r.length;e+=1)for(let o=0;o<r[e].length;o+=1)t.push(r[e][o]);return t},this.getSourceData=function(e,t,o,r){return void 0===e?Q.getData():Q.getByRange(J._createCellCoords(e,t),J._createCellCoords(o,r))},this.getSourceDataArray=function(e,t,o,r){return void 0===e?Q.getData(!0):Q.getByRange(J._createCellCoords(e,t),J._createCellCoords(o,r),!0)},this.getSourceDataAtCol=function(e){return Q.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,o,r){let n=ec(e,t,o),i=this.hasHook("afterSetSourceDataAtCell"),s=[];i&&(0,d.arrayEach)(n,e=>{let[t,o,r]=e;s.push([t,o,Q.getAtCell(t,o),r])}),(0,d.arrayEach)(n,e=>{let[t,o,r]=e;Q.setAtCell(t,o,r)}),i&&this.runHooks("afterSetSourceDataAtCell",s,r),this.render();let a=J.getActiveEditor();a&&(0,l.isDefined)(a.refreshValue)&&a.refreshValue()},this.getSourceDataAtRow=function(e){return Q.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return Q.getAtCell(e,t)},this.getDataAtRow=function(e){return o.getRange(J._createCellCoords(e,0),J._createCellCoords(e,this.countCols()-1),o.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,o,r){let n=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,o,r],[l,i]=n,[,,s,a]=n,u=null,c=null;void 0===s&&(s=l),void 0===a&&(a=i);let d="mixed";return(0,C.rangeEach)(Math.max(Math.min(l,s),0),Math.max(l,s),e=>{let t=!0;return(0,C.rangeEach)(Math.max(Math.min(i,a),0),Math.max(i,a),o=>(c=this.getCellMeta(e,o).type,u?t=u===c:u=c,t)),d=t?c:"mixed",t}),d},this.removeCellMeta=function(e,t,o){let[r,n]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],l=ee.getCellMetaKeyValue(r,n,o);!1!==J.runHooks("beforeRemoveCellMeta",e,t,o,l)&&(ee.removeCellMeta(r,n,o),J.runHooks("afterRemoveCellMeta",e,t,o,l))},this.spliceCellsMeta=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var o=arguments.length,r=Array(o>2?o-2:0),n=2;n<o;n++)r[n-2]=arguments[n];if(r.length>0&&!Array.isArray(r[0]))throw Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");t>0&&ee.removeRow(this.toPhysicalRow(e),t),r.length>0&&(0,d.arrayEach)(r.reverse(),t=>{ee.createRow(this.toPhysicalRow(e)),(0,d.arrayEach)(t,(t,o)=>this.setCellMetaObject(e,o,t))}),J.render()},this.setCellMetaObject=function(e,t,o){"object"==typeof o&&(0,u.objectEach)(o,(o,r)=>{this.setCellMeta(e,t,r,o)})},this.setCellMeta=function(e,t,o,r){if(!1===J.runHooks("beforeSetCellMeta",e,t,o,r))return;let n=e,l=t;e<this.countRows()&&(n=this.toPhysicalRow(e)),t<this.countCols()&&(l=this.toPhysicalColumn(t)),ee.setCellMeta(n,l,o,r),J.runHooks("afterSetCellMeta",e,t,o,r)},this.getCellsMeta=function(){return ee.getCellsMeta()},this.getCellMeta=function(e,t){let o=this.toPhysicalRow(e),r=this.toPhysicalColumn(t);return null===o&&(o=e),null===r&&(r=t),ee.getCellMeta(o,r,{visualRow:e,visualColumn:t})},this.getColumnMeta=function(e){return ee.getColumnMeta(this.toPhysicalColumn(e))},this.getCellMetaAtRow=function(e){return ee.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===J.dataType||et.columns)},this.getCellRenderer=function(e,t){let o="number"==typeof e?J.getCellMeta(e,t).renderer:e.renderer;return"string"==typeof o?(0,g.gB)(o):(0,l.isUndefined)(o)?(0,g.gB)("text"):o},this.getCellEditor=function(e,t){let o="number"==typeof e?J.getCellMeta(e,t).editor:e.editor;return"string"==typeof o?(0,m.M8)(o):(0,l.isUndefined)(o)?(0,m.M8)("text"):o},this.getCellValidator=function(e,t){let o="number"==typeof e?J.getCellMeta(e,t).validator:e.validator;return"string"==typeof o?(0,p.by)(o):o},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,o){let r=new es;e&&(r.onQueueEmpty=e);let n=J.countRows()-1;for(;n>=0;){if(void 0!==t&&-1===t.indexOf(n)){n-=1;continue}let e=J.countCols()-1;for(;e>=0;){if(void 0!==o&&-1===o.indexOf(e)){e-=1;continue}r.addValidatorToQueue(),J.validateCell(J.getDataAtCell(n,e),J.getCellMeta(n,e),e=>{if("boolean"!=typeof e)throw Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()},"validateCells"),e-=1}n-=1}r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=et.rowHeaders,o=e;return void 0!==o&&(o=J.runHooks("modifyRowHeader",o)),void 0===o?(t=[],(0,C.rangeEach)(J.countRows()-1,e=>{t.push(J.getRowHeader(e))})):Array.isArray(t)&&void 0!==t[o]?t=t[o]:(0,n.isFunction)(t)?t=t(o):t&&"string"!=typeof t&&"number"!=typeof t&&(t=o+1),t},this.hasRowHeaders=function(){return!!et.rowHeaders},this.hasColHeaders=function(){if(void 0!==et.colHeaders&&null!==et.colHeaders)return!!et.colHeaders;for(let e=0,t=J.countCols();e<t;e++)if(J.getColHeader(e))return!0;return!1},this.getColHeader=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=J.runHooks("modifyColHeader",e);if(void 0===o){let e=[],t=J.countCols();for(let o=0;o<t;o++)e.push(J.getColHeader(o));return e}let r=et.colHeaders,l=J.toPhysicalColumn(o),i=function(e){let t=[],o=J.countCols(),r=0;for(;r<o;r++)(0,n.isFunction)(et.columns)&&et.columns(r)&&t.push(r);return t[e]}(l);return!1===et.colHeaders?r=null:et.columns&&(0,n.isFunction)(et.columns)&&et.columns(i)&&et.columns(i).title?r=et.columns(i).title:et.columns&&et.columns[l]&&et.columns[l].title?r=et.columns[l].title:Array.isArray(et.colHeaders)&&void 0!==et.colHeaders[l]?r=et.colHeaders[l]:(0,n.isFunction)(et.colHeaders)?r=et.colHeaders(l):et.colHeaders&&"string"!=typeof et.colHeaders&&"number"!=typeof et.colHeaders&&(r=(0,R.spreadsheetColumnLabel)(o)),r=J.runHooks("modifyColumnHeaderValue",r,e,t)},this._getColWidthFromSettings=function(e){let t;if(e>=0&&(t=J.getCellMeta(0,e).width),(void 0===t||t===et.width)&&(t=et.colWidths),null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e,t){let o=J._getColWidthFromSettings(e);return void 0===(o=J.runHooks("modifyColWidth",o,e,t))&&(o=E.j),o},this._getRowHeightFromSettings=function(e){let t=et.rowHeights;if(null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e,t){let o=J._getRowHeightFromSettings(e);return J.runHooks("modifyRowHeight",o,e,t)},this.countSourceRows=function(){return Q.countRows()},this.countSourceCols=function(){return Q.countFirstRowKeys()},this.countRows=function(){return o.getLength()},this.countCols=function(){return Math.min(et.maxCols,this.columnIndexMapper.getNotTrimmedIndexesLength())},this.countRenderedRows=function(){return J.view._wt.drawn?J.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return J.view._wt.drawn?J.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return J.view._wt.drawn?J.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return J.view._wt.drawn?J.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,C.rangeEachReverse)(J.countRows()-1,o=>{if(J.isEmptyRow(o))t+=1;else if(!0===e)return!1}),t},this.countEmptyCols=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,C.rangeEachReverse)(J.countCols()-1,o=>{if(J.isEmptyCol(o))t+=1;else if(!0===e)return!1}),t},this.isEmptyRow=function(e){return et.isEmptyRow.call(J,e)},this.isEmptyCol=function(e){return et.isEmptyCol.call(J,e)},this.selectCell=function(e,t,o,r){let n=!(arguments.length>4)||void 0===arguments[4]||arguments[4],i=!(arguments.length>5)||void 0===arguments[5]||arguments[5];return!((0,l.isUndefined)(e)||(0,l.isUndefined)(t))&&this.selectCells([[e,t,o,r]],n,i)},this.selectCells=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=!(arguments.length>2)||void 0===arguments[2]||arguments[2];!1===t&&K.suspend();let r=en.selectCells(e);return r&&o&&J.listen(),K.resume(),r},this.selectColumns=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2?arguments[2]:void 0;return en.selectColumns(e,t,o)},this.selectRows=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2?arguments[2]:void 0;return en.selectRows(e,t,o)},this.deselectCell=function(){en.deselect()},this.selectAll=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2?arguments[2]:void 0;K.skipNextScrollCycle(),en.selectAll(e,t,o)};let eh=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e){if("number"==typeof e){var t;e={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(t=arguments[4])||void 0===t||t}}let{row:o,col:r,considerHiddenIndexes:n}=null!=e?e:{},l=o,i=r;if(void 0===n||n){let e=Number.isInteger(o)&&o>=0,t=Number.isInteger(r)&&r>=0,n=e?eh(this.rowIndexMapper,o):void 0,s=t?eh(this.columnIndexMapper,r):void 0;if(null===n||null===s)return!1;l=e?J.rowIndexMapper.getRenderableFromVisualIndex(n):o,i=t?J.columnIndexMapper.getRenderableFromVisualIndex(s):r}let s=Number.isInteger(l),a=Number.isInteger(i);return s&&l>=0&&a&&i>=0?J.view.scrollViewport(J._createCellCoords(l,i),e.horizontalSnap,e.verticalSnap):s&&l>=0&&(a&&i<0||!a)?J.view.scrollViewportVertically(l,e.verticalSnap):!!a&&i>=0&&(!!s&&l<0||!s)&&J.view.scrollViewportHorizontally(i,e.horizontalSnap)},this.scrollToFocusedCell=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",e);let{highlight:t}=this.getSelectedRangeLast();this.scrollViewportTo(t.toObject())?this.view.render():(this.removeHook("afterScroll",e),this._registerImmediate(()=>e()))},this.destroy=function(){if(J._clearTimeouts(),J._clearImmediates(),J.view&&J.view.destroy(),Q&&Q.destroy(),Q=null,this.getShortcutManager().destroy(),ee.clearCache(),j.delete(this.guid),(0,S.yn)(J)){let e=this.rootDocument.querySelector(".hot-display-license-info");e&&e.parentNode.removeChild(e)}(0,r.empty)(J.rootElement),G.destroy(),W&&W.destroy(),J.batchExecution(()=>{J.rowIndexMapper.unregisterAll(),J.columnIndexMapper.unregisterAll(),er.getItems().forEach(e=>{let[,t]=e;t.destroy()}),er.clear(),J.runHooks("afterDestroy")},!0),H.R.getSingleton().destroy(J),(0,u.objectEach)(J,(e,t,o)=>{(0,n.isFunction)(e)?o[t]=()=>{throw Error(`The "${t}" method cannot be called because this Handsontable instance has been destroyed`)}:"guid"!==t&&(o[t]=null)}),J.isDestroyed=!0,o&&o.destroy(),o=null,z=null,en=null,W=null,J=null},this.getActiveEditor=function(){return W.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return J.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return J.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return J.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return J.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return J.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return J.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return J.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return J.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return J.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return J.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return J.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return J.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(e){return er.getItem((0,w.toUpperCaseFirst)(e))},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:er.getId(e)},this.getInstance=function(){return J},this.addHook=function(e,t,o){H.R.getSingleton().add(e,t,J,o)},this.hasHook=function(e){return H.R.getSingleton().has(e,J)||H.R.getSingleton().has(e)},this.addHookOnce=function(e,t,o){H.R.getSingleton().once(e,t,J,o)},this.removeHook=function(e,t){H.R.getSingleton().remove(e,t,J)},this.runHooks=function(e,t,o,r,n,l,i){return H.R.getSingleton().run(J,e,t,o,r,n,l,i)},this.getTranslatedPhrase=function(e,t){return(0,A.E9)(et.language,e,t)},this.toHTML=()=>(0,h.instanceToHTML)(this),this.toTableElement=()=>{let e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",(0,h.instanceToHTML)(this)),e.firstElementChild},this.timeouts=[],this.useTheme=e=>{this.view.getStylesHandler().useTheme(e),this.runHooks("afterSetTheme",e,!!Y)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=e;"function"==typeof o&&(o=setTimeout(o,t)),this.timeouts.push(o)},this._clearTimeouts=function(){(0,d.arrayEach)(this.timeouts,e=>{clearTimeout(e)})},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){(0,d.arrayEach)(this.immediates,e=>{clearImmediate(e)})},this._getEditorManager=function(){return W},this.isRtl=function(){return"rtl"===J.rootWindow.getComputedStyle(J.rootElement).direction},this.isLtr=function(){return!J.isRtl()},this.getDirectionFactor=function(){return J.isLtr()?1:-1};let ef=(0,L.s)({handleEvent:()=>J.isListening(),beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||J.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",e=>{!1===e.ctrlKey&&!1===e.metaKey&&ef.releasePressedKeys()}),this.getShortcutManager=function(){return ef},this.getFocusManager=function(){return B},(0,f.f4)().forEach(e=>{let t=(0,f.sd)(e);er.addItem(e,new t(this))}),(0,N.rl)(J),ef.setActiveContextName("grid"),H.R.getSingleton().run(J,"construct")}}}]);